# Vibe IDE â€” Deployable Architecture

**What you get**
- `index.html` â€” the IDE (stays online)
- `sample.html` â€” the live page you overwrite on publish
- `assets/env.js` â€” environment passed to the IDE (Projects can rewrite this)
- Minimal `*.tf` â€” safe, resource-free outputs for Projects UI

**How it works**
- IDE loads `sample.html` by default.
- When you Push ðŸš€, only `sample.html` on your site is updated.
- The IDE remains available at its own URL.

**Wire a broker (optional)**
- Set Terraform var `push_api_url` to your Code Engine broker endpoint.
- The IDE will POST the HTML to that endpoint and auto-refresh the live site.

---

## `env.js` Integration Contract

The `index.html` file (the Vibe IDE) is decoupled from the underlying cloud resources. It relies on a dynamically-loaded `assets/env.js` file to provide the necessary endpoints and context.

An IBM Cloud Project that consumes this deployable architecture **must** generate and deploy this `assets/env.js` file alongside `index.html`. This file's sole purpose is to create a global `window.__VIBE_ENV__` object.

The IDE reads from this object to determine:
1.  Where to send the HTML when the user clicks "Push ðŸš€".
2.  What URL to copy when the user clicks "live vibe".

### Example `assets/env.js`

Here is an example of a valid `env.js` file. The values would be populated by the integrating project's Terraform outputs.

```javascript
/*
 * This file is dynamically generated by the IBM Cloud Project's
 * automation. It bridges the Vibe IDE with the live cloud resources.
 */
window.__VIBE_ENV__ = {
  // The base URL of the live static site (e.g., COS public URL or CNAME)
  // Used by the "live vibe" button.
  PROJECT_URL: "[https://my-project-site.us-south.codeengine.appdomain.cloud](https://my-project-site.us-south.codeengine.appdomain.cloud)",
  
  // The endpoint for the Code Engine broker that receives the HTML POST.
  // Used by the "Push ðŸš€" button.
  PUSH_API_URL: "[https://my-broker.us-south.codeengine.appdomain.cloud](https://my-broker.us-south.codeengine.appdomain.cloud)",
  
  // The target file path for the live site
  PRIMARY_OUTPUT: "sample.html",

  // Other contextual values (optional, but good to include)
  REGION: "us-south",
  PREFIX: "my-project-prefix",
  VIBE_VERSION: "1.0.0"
};